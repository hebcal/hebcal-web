/*! hebcal-app-5.1.3.min.js */
var hebcalClient=function(){"use strict";
/**
   * Bootstrap 5 autocomplete
   * https://github.com/lekoala/bootstrap5-autocomplete
   * @license MIT
   */const e={showAllSuggestions:!1,suggestionsThreshold:1,maximumItems:0,autoselectFirst:!0,ignoreEnter:!1,tabSelect:!1,updateOnSelect:!1,highlightTyped:!1,highlightClass:"",fullWidth:!1,fixed:!1,fuzzy:!1,startsWith:!1,fillIn:!1,preventBrowserAutocomplete:!1,itemClass:"",activeClasses:["bg-primary","text-white"],labelField:"label",valueField:"value",searchFields:["label"],queryParam:"query",items:[],source:null,hiddenInput:!1,hiddenValue:"",clearControl:"",datalist:"",server:"",serverMethod:"GET",serverParams:{},serverDataKey:"data",fetchOptions:{},liveServer:!1,noCache:!0,debounceTime:300,notFoundMessage:"",onRenderItem:(e,t,s)=>t,onSelectItem:(e,t)=>{},onClearItem:(e,t)=>{},onServerResponse:(e,t)=>e.json(),onServerError:(e,t,s)=>{"AbortError"===e.name||t.aborted||console.error(e)},onChange:(e,t)=>{},onBeforeFetch:e=>{},onAfterFetch:e=>{}},t="is-loading",s="is-active",i="show",n="next",o="prev",r=new WeakMap;let a=0,h=0;function l(e){return e?function(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}(e.toString()).toLowerCase():""}function c(e,t){if(e.indexOf(t)>=0)return!0;let s=0;for(let i=0;i<t.length;i++){const n=t[i];if(" "!==n&&(s=e.indexOf(n,s)+1,s<=0))return!1}return!0}function u(e,t){return e.parentNode.insertBefore(t,e.nextSibling)}function d(e,t){for(const[s,i]of Object.entries(t))e.setAttribute(s,i)}class p{constructor(e,t={}){if(!(e instanceof HTMLElement))return void console.error("Invalid element",e);r.set(e,this),a++,h++,this._searchInput=e,this._configure(t),this._isMouse=!1,this._preventInput=!1,this._keyboardNavigation=!1,this._searchFunc=function(e,t=300){let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>{e.apply(this,i)},t)}}(()=>{this._loadFromServer(!0)},this._config.debounceTime),this._configureSearchInput(),this._configureDropElement(),this._config.fixed&&(document.addEventListener("scroll",this,!0),window.addEventListener("resize",this));const s=this._getClearControl();s&&s.addEventListener("click",this),["focus","change","blur","input","beforeinput","keydown"].forEach(e=>{this._searchInput.addEventListener(e,this)}),["mousemove","mouseenter","mouseleave"].forEach(e=>{this._dropElement.addEventListener(e,this)}),this._fetchData()}static init(e="input.autocomplete",t={}){document.querySelectorAll(e).forEach(e=>{this.getOrCreateInstance(e,t)})}static getInstance(e){return r.has(e)?r.get(e):null}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,t)}dispose(){h--,["focus","change","blur","input","beforeinput","keydown"].forEach(e=>{this._searchInput.removeEventListener(e,this)}),["mousemove","mouseenter","mouseleave"].forEach(e=>{this._dropElement.removeEventListener(e,this)});const e=this._getClearControl();e&&e.removeEventListener("click",this),this._config.fixed&&h<=0&&(document.removeEventListener("scroll",this,!0),window.removeEventListener("resize",this)),this._dropElement.parentElement.removeChild(this._dropElement),r.delete(this._searchInput)}_getClearControl(){if(this._config.clearControl)return document.querySelector(this._config.clearControl)}handleEvent=e=>{["scroll","resize"].includes(e.type)?(this._timer&&window.cancelAnimationFrame(this._timer),this._timer=window.requestAnimationFrame(()=>{this[`on${e.type}`](e)})):this[`on${e.type}`](e)};_configure(t={}){this._config=Object.assign({},e);const s={...t,...this._searchInput.dataset},i=e=>["true","false","1","0",!0,!1].includes(e)&&!!JSON.parse(e);for(const[t,n]of Object.entries(e)){if(void 0===s[t])continue;const e=s[t];switch(typeof n){case"number":this._config[t]=parseInt(e);break;case"boolean":this._config[t]=i(e);break;case"string":this._config[t]=e.toString();break;case"object":if(Array.isArray(n))if("string"==typeof e){const s=e.includes("|")?"|":",";this._config[t]=e.split(s)}else this._config[t]=e;else this._config[t]="string"==typeof e?JSON.parse(e):e;break;case"function":this._config[t]="string"==typeof e?window[e]:e;break;default:this._config[t]=e}}}_configureSearchInput(){if(this._searchInput.autocomplete="off",this._searchInput.spellcheck=!1,d(this._searchInput,{"aria-autocomplete":"list","aria-haspopup":"menu","aria-expanded":"false",role:"combobox"}),this._searchInput.id&&this._config.preventBrowserAutocomplete){const t=document.querySelector(`[for="${this._searchInput.id}"]`);t&&((e=t).ariaLabel=e.innerText,e.innerHTML=e.innerText.split("").map(e=>e+"&zwj;").join(""))}var e;this._hiddenInput=null,this._config.hiddenInput&&(this._hiddenInput=document.createElement("input"),this._hiddenInput.type="hidden",this._hiddenInput.value=this._config.hiddenValue,this._hiddenInput.name=this._searchInput.name,this._searchInput.name="_"+this._searchInput.name,u(this._searchInput,this._hiddenInput))}_configureDropElement(){this._dropElement=document.createElement("ul"),this._dropElement.id="ac-menu-"+a,this._dropElement.classList.add("dropdown-menu","autocomplete-menu","p-0"),this._dropElement.style.maxHeight="280px",this._config.fullWidth||(this._dropElement.style.maxWidth="360px"),this._config.fixed&&(this._dropElement.style.position="fixed"),this._dropElement.style.overflowY="auto",this._dropElement.style.overscrollBehavior="contain",this._dropElement.style.textAlign="unset",u(this._searchInput,this._dropElement),this._searchInput.setAttribute("aria-controls",this._dropElement.id)}onclick(e){e.target instanceof Element&&e.target.matches(this._config.clearControl)&&this.clear()}onbeforeinput(e){this._preventInput||this._hiddenInput&&this._hiddenInput.value&&(this._config.onClearItem(this._searchInput.value,this),this._hiddenInput.value=null)}oninput(e){this._preventInput||this.showOrSearch()}onchange(e){const t=this._searchInput.value,s=this._items.find(e=>e.label===t);this._config.onChange(s,this)}onblur(e){const t=e.relatedTarget;this._isMouse&&t instanceof HTMLElement&&(t.classList.contains("modal")||t.classList.contains("autocomplete-menu"))?this._searchInput.focus():setTimeout(()=>{this.hideSuggestions()},100)}onfocus(e){this.showOrSearch()}onkeydown(e){switch(e.keyCode||e.key){case 13:case"Enter":if(this.isDropdownVisible()){const t=this.getSelection();t&&t.click(),!t&&this._config.ignoreEnter||e.preventDefault()}break;case 9:case"Tab":if(this.isDropdownVisible()&&this._config.tabSelect){const t=this.getSelection();t&&(t.click(),e.preventDefault())}break;case 38:case"ArrowUp":e.preventDefault(),this._keyboardNavigation=!0,this._moveSelection(o);break;case 40:case"ArrowDown":e.preventDefault(),this._keyboardNavigation=!0,this.isDropdownVisible()?this._moveSelection(n):this.showOrSearch(!1);break;case 27:case"Escape":this.isDropdownVisible()&&(this._searchInput.focus(),this.hideSuggestions())}}onmouseenter(e){this._isMouse=!0}onmousemove(e){this._isMouse=!0,this._keyboardNavigation=!1}onmouseleave(e){this._isMouse=!1,this.removeSelection()}onscroll(e){this._positionMenu()}onresize(e){this._positionMenu()}getConfig(e=null){return null!==e?this._config[e]:this._config}setConfig(e,t){this._config[e]=t}setData(e){this._items=[],this._addItems(e)}enable(){this._searchInput.setAttribute("disabled","")}disable(){this._searchInput.removeAttribute("disabled")}isDisabled(){return this._searchInput.hasAttribute("disabled")||this._searchInput.disabled||this._searchInput.hasAttribute("readonly")}isDropdownVisible(){return this._dropElement.classList.contains(i)}clear(){const e=this._searchInput.value;this._searchInput.value="",this._hiddenInput&&(this._hiddenInput.value=""),this._config.onClearItem(e,this)}getSelection(){return this._dropElement.querySelector("a."+s)}removeSelection(){const e=this.getSelection();e&&e.classList.remove(...this._activeClasses())}_activeClasses(){return[...this._config.activeClasses,s]}_isItemEnabled(e){if("none"===e.style.display)return!1;const t=e.firstElementChild;return"A"===t.tagName&&!t.classList.contains("disabled")}_moveSelection(e=n,t=null){const s=this.getSelection();if(s){const i=e===n?"nextSibling":"previousSibling";t=s.parentNode;do{t=t[i]}while(t&&!this._isItemEnabled(t));t?(s.classList.remove(...this._activeClasses()),e===o?t.parentNode.scrollTop=t.offsetTop-t.parentNode.offsetTop:t.offsetTop>t.parentNode.offsetHeight-t.offsetHeight&&(t.parentNode.scrollTop+=t.offsetHeight)):s&&(t=s.parentElement)}else{if(e===o)return t;if(!t)for(t=this._dropElement.firstChild;t&&!this._isItemEnabled(t);)t=t.nextSibling}if(t){const e=t.querySelector("a");e.classList.add(...this._activeClasses()),this._searchInput.setAttribute("aria-activedescendant",e.id),this._config.updateOnSelect&&(this._searchInput.value=e.dataset.label)}else this._searchInput.setAttribute("aria-activedescendant","");return t}_shouldShow(){return!this.isDisabled()&&this._searchInput.value.length>=this._config.suggestionsThreshold}showOrSearch(e=!0){!e||this._shouldShow()?this._config.liveServer?this._searchFunc():this._config.source?this._config.source(this._searchInput.value,e=>{this.setData(e),this._showSuggestions()}):this._showSuggestions():this.hideSuggestions()}_createGroup(e){const t=this._createLi(),s=document.createElement("span");return t.append(s),s.classList.add("dropdown-header","text-truncate"),s.innerHTML=e,t}_createItem(e,t){let s=t.label;if(this._config.highlightTyped){const t=l(s).indexOf(e);-1!==t&&(s=s.substring(0,t)+`<mark class="${this._config.highlightClass}">${s.substring(t,t+e.length)}</mark>`+s.substring(t+e.length,s.length))}s=this._config.onRenderItem(t,s,this);const i=this._createLi(),n=document.createElement("a");if(i.append(n),n.id=this._dropElement.id+"-"+this._dropElement.children.length,n.classList.add("dropdown-item","text-truncate"),this._config.itemClass&&n.classList.add(...this._config.itemClass.split(" ")),n.setAttribute("data-value",t.value),n.setAttribute("data-label",t.label),n.setAttribute("tabindex","-1"),n.setAttribute("role","menuitem"),n.setAttribute("href","#"),n.innerHTML=s,t.data)for(const[e,s]of Object.entries(t.data))n.dataset[e]=s;if(this._config.fillIn){const e=document.createElement("button");e.type="button",e.classList.add("btn","btn-link","border-0"),e.innerHTML='<svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n      <path fill-rule="evenodd" d="M2 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1H3.707l10.147 10.146a.5.5 0 0 1-.708.708L3 3.707V8.5a.5.5 0 0 1-1 0z"/>\n      </svg>',i.append(e),i.classList.add("d-flex","justify-content-between"),e.addEventListener("click",e=>{this._searchInput.value=t.label,this._searchInput.focus()})}return n.addEventListener("mouseenter",e=>{if(this._keyboardNavigation||!this._isMouse)return;this.removeSelection();const t=i.querySelector("a");t.classList.add(...this._activeClasses()),this._searchInput.setAttribute("aria-activedescendant",t.id)}),n.addEventListener("mousedown",e=>{e.preventDefault()}),n.addEventListener("click",e=>{e.preventDefault(),this._preventInput=!0,this._searchInput.value=function(e){const t=document.createElement("textarea");return t.innerHTML=e,t.value}(t.label),this._hiddenInput&&(this._hiddenInput.value=t.value),this._config.onSelectItem(t,this),this.hideSuggestions(),this._preventInput=!1}),i}_getActiveElement(e=document){const t=e.activeElement;return t?t.shadowRoot?this._getActiveElement(t.shadowRoot):t:null}_showSuggestions(){if(this._getActiveElement()!==this._searchInput)return;const e=l(this._searchInput.value);this._dropElement.innerHTML="";let t=0,s=null;const i=[];for(const n of this._items){const o=this._config.showAllSuggestions||0===e.length;let r=0===e.length&&0===this._config.suggestionsThreshold;e.length>0&&this._config.searchFields.forEach(t=>{const s=l(n[t]);let i=!1;if(this._config.fuzzy)i=c(s,e);else{const t=s.indexOf(e);i=this._config.startsWith?0===t:t>=0}i&&(r=!0)});const a=r||0===e.length;if(o||r){if(t++,n.group&&!i.includes(n.group)){const e=this._createGroup(n.group);this._dropElement.appendChild(e),i.push(n.group)}const o=this._createItem(e,n);if(!s&&a&&(s=o),this._dropElement.appendChild(o),this._config.maximumItems>0&&t>=this._config.maximumItems)break}}if(s&&this._config.autoselectFirst&&(this.removeSelection(),this._moveSelection(n,s)),0===t)if(this._config.notFoundMessage){const e=this._createLi();e.innerHTML=`<span class="dropdown-item">${this._config.notFoundMessage}</span>`,this._dropElement.appendChild(e),this._showDropdown()}else this.hideSuggestions();else this._showDropdown()}_createLi(){const e=document.createElement("li");return e.setAttribute("role","presentation"),e}_showDropdown(){this._dropElement.classList.add(i),this._dropElement.setAttribute("role","menu"),d(this._searchInput,{"aria-expanded":"true"}),this._positionMenu()}toggleSuggestions(e=!0){this._dropElement.classList.contains(i)?this.hideSuggestions():this.showOrSearch(e)}hideSuggestions(){this._dropElement.classList.remove(i),d(this._searchInput,{"aria-expanded":"false"}),this.removeSelection()}getInput(){return this._searchInput}getDropMenu(){return this._dropElement}_positionMenu(){const e=this._searchInput.getBoundingClientRect(),t="rtl"===this._searchInput.dir||""===this._searchInput.dir&&"rtl"===document.dir,s=this._config.fullWidth;let i=null,n=null;this._config.fixed&&(i=e.x,n=e.y+e.height,t&&!s&&(i-=this._dropElement.offsetWidth-e.width)),this._dropElement.style.transform="unset",s&&(this._dropElement.style.width=this._searchInput.offsetWidth+"px"),null!==i&&(this._dropElement.style.left=i+"px"),null!==n&&(this._dropElement.style.top=n+"px");const o=this._dropElement.getBoundingClientRect(),r=window.innerHeight;if(o.y+o.height>r){const t=s?e.height+4:e.height;this._dropElement.style.transform="translateY(calc(-100.1% - "+t+"px))"}}_fetchData(){this._items=[],this._addItems(this._config.items);const e=this._config.datalist;if(e){const t=document.querySelector(`#${e}`);if(t){const e=Array.from(t.children).map(e=>({value:e.getAttribute("value")??e.innerHTML.toLowerCase(),label:e.innerHTML}));this._addItems(e)}else console.error(`Datalist not found ${e}`)}this._setHiddenVal(),this._config.server&&!this._config.liveServer&&this._loadFromServer()}_setHiddenVal(){if(this._config.hiddenInput&&!this._config.hiddenValue)for(const e of this._items)e.label==this._searchInput.value&&(this._hiddenInput.value=e.value)}_normalizeData(e){if(Array.isArray(e))return e;let t=[];for(const[s,i]of Object.entries(e))t.push({value:s,label:i});return t}_addItems(e){e=this._normalizeData(e);for(const t of e){if(t.group&&t.items){t.items.forEach(e=>e.group=t.group),this._addItems(t.items);continue}const e="string"==typeof t?t:t.label,s="object"!=typeof t?{}:t;s.label=t[this._config.labelField]??e,s.value=t[this._config.valueField]??e,s.label&&this._items.push(s)}}_loadFromServer(e=!1){this._abortController&&this._abortController.abort(),this._abortController=new AbortController,this._config.onBeforeFetch(this);let s=this._searchInput.dataset.serverParams||{};"string"==typeof s&&(s=JSON.parse(s));const i=Object.assign({},this._config.serverParams,s);if(i[this._config.queryParam]=this._searchInput.value,this._config.noCache&&(i.t=Date.now()),i.related){(Array.isArray(i.related)?i.related:[i.related]).forEach(e=>{const t=document.getElementById(e);if(t&&t.hasAttribute("name")){const e=t.value,s=t.getAttribute("name");s&&(i[s]=e)}})}const n=new URLSearchParams(i);let o=this._config.server,r=Object.assign(this._config.fetchOptions,{method:this._config.serverMethod||"GET",signal:this._abortController.signal});"POST"===r.method?r.body=n:(-1==o.indexOf("?")?o+="?":o+="&",o+=n.toString()),this._searchInput.classList.add(t),fetch(o,r).then(e=>this._config.onServerResponse(e,this)).then(t=>{const s=function(e,t="window"){return e.split(".").reduce((e,t)=>e[t],t)}(this._config.serverDataKey,t)||t;this.setData(s),this._setHiddenVal(),this._abortController=null,e&&this._showSuggestions()}).catch(e=>{this._config.onServerError(e,this._abortController.signal,this)}).finally(e=>{this._searchInput.classList.remove(t),this._config.onAfterFetch(this)})}}return{createCityTypeahead:function(e,t){const s=-1===navigator.userAgent.indexOf("Win"),i=document.getElementById("city-typeahead"),n=new p(i,{noCache:!1,liveServer:!0,server:"/complete.php",fetchOptions:{method:"GET",credentials:"omit",mode:"cors"},queryParam:"q",labelField:"value",valueField:"value",maximumItems:10,showAllSuggestions:!0,preventBrowserAutocomplete:!0,fixed:Boolean(t),onBeforeFetch:e=>{e._config.notFoundMessage=void 0;const t=i.value;if(t.length){const s=t.replace(/[\u00A0-\u9999<>&]/gim,function(e){return`&#${e.charCodeAt(0)};`});e._config.notFoundMessage=`Sorry, no city names match <b>${s}</b>.`}},onServerResponse:(e,t)=>e.ok?e.json():404===e.status?Promise.resolve([]):e.json(),onSelectItem:(t,s)=>{if(h(t),e){const e=document.getElementById("shabbat-form");e&&e.submit()}},onRenderItem:(e,t,i)=>{if(1===Object.keys(i._items).length&&h(e),"zip"===e.geo){const t=s&&e.flag?" "+e.flag:"";return`${e.asciiname}, ${e.admin1} <strong>${e.id}</strong> - USA${t}`}{const t=e.country,i="United Kingdom"==t?"UK":"United States"==t?"USA":t;let n=i||"";const o=`<strong>${e.name||e.asciiname}</strong>`,r="IL"===e.cc?"":e.admin1||"";i&&"string"==typeof r&&r.length>0&&!r.startsWith(e.asciiname)&&(n=`${r}, ${n}`),n&&(n=` - <small>${n}</small>`);return`${o}${n}${s&&e.flag?" "+e.flag:""}`}}});function o(e,t){const s=document.getElementById(e);s&&(s.value=t)}let r=!1;function a(){r=!1,o("geo","none"),o("c","off"),o("geonameid",""),o("zip","")}function h(e){const t=e.geo,s=e.id;"zip"===t?(o("zip",s),o("geonameid","")):(o("geonameid",s),o("zip","")),o("geo",t),o("c","on"),r=!0}let l=!1;i.addEventListener("keydown",function(t){e||i.value.length||a();const s=i.value,o="string"==typeof s?s.trim():"",c=o.charCodeAt(0);if(c>=48&&c<=57&&/^\d\d\d\d\d/.test(o)){h({geo:"zip",id:o.substring(0,5)})}if("Enter"===t.key){return n.getSelection()||n._moveSelection("next"),r?!0:(t.preventDefault(),!1)}return"Backspace"===t.key&&l&&(a(),n.hideSuggestions(),n.clear()),l=!1,!0}),i.addEventListener("focus",function(){l=!0});const c=document.querySelector(".clear-btn");c.addEventListener("click",()=>{i.value="",i.focus(),i.dispatchEvent(new Event("input"))}),i.addEventListener("input",()=>{c.style.display=i.value?"block":"none"})}}}();
